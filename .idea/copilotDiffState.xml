<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/backend/pom_new.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/backend/pom_new.xml" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&#10;&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;&#10;         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&#10;         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;&#10;&#10;    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;&#10;&#10;    &lt;parent&gt;&#10;        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;&#10;        &lt;version&gt;3.2.5&lt;/version&gt;&#10;        &lt;relativePath/&gt;&#10;    &lt;/parent&gt;&#10;&#10;    &lt;groupId&gt;com.example&lt;/groupId&gt;&#10;    &lt;artifactId&gt;BudgetBites&lt;/artifactId&gt;&#10;    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;&#10;    &lt;name&gt;BudgetBites&lt;/name&gt;&#10;    &lt;description&gt;BudgetBites&lt;/description&gt;&#10;&#10;    &lt;properties&gt;&#10;        &lt;java.version&gt;21&lt;/java.version&gt;&#10;    &lt;/properties&gt;&#10;&#10;    &lt;dependencies&gt;&#10;        &lt;!-- Core Spring Boot --&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&#10;        &lt;/dependency&gt;&#10;&#10;        &lt;!-- Email support --&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;            &lt;artifactId&gt;spring-boot-starter-mail&lt;/artifactId&gt;&#10;        &lt;/dependency&gt;&#10;&#10;        &lt;!-- Persistence --&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;            &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;&#10;        &lt;/dependency&gt;&#10;&#10;        &lt;!-- PostgreSQL JDBC driver --&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.postgresql&lt;/groupId&gt;&#10;            &lt;artifactId&gt;postgresql&lt;/artifactId&gt;&#10;        &lt;/dependency&gt;&#10;&#10;        &lt;!-- Testing --&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;&#10;            &lt;scope&gt;test&lt;/scope&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;            &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;&#10;        &lt;/dependency&gt;&#10;        &lt;dependency&gt;&#10;            &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;&#10;            &lt;artifactId&gt;spring-security-test&lt;/artifactId&gt;&#10;            &lt;scope&gt;test&lt;/scope&gt;&#10;        &lt;/dependency&gt;&#10;    &lt;/dependencies&gt;&#10;&#10;    &lt;build&gt;&#10;        &lt;plugins&gt;&#10;            &lt;plugin&gt;&#10;                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;&#10;            &lt;/plugin&gt;&#10;        &lt;/plugins&gt;&#10;    &lt;/build&gt;&#10;&lt;/project&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/backend/src/main/java/com/example/budgetbites/AuthController.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/backend/src/main/java/com/example/budgetbites/AuthController.java" />
              <option name="originalContent" value="package com.example.budgetbites;&#10;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.http.ResponseEntity;&#10;import org.springframework.web.bind.annotation.*;&#10;&#10;import java.util.List;&#10;import java.util.stream.Collectors;&#10;&#10;@RestController&#10;@RequestMapping(&quot;/auth&quot;)&#10;public class AuthController {&#10;    @Autowired&#10;    private AuthService authService;&#10;&#10;    @Autowired&#10;    private UserRepository userRepository;&#10;&#10;    // Nový endpoint pro registraci s emailem&#10;    @PostMapping(&quot;/register&quot;)&#10;    public ResponseEntity&lt;String&gt; registerWithEmail(@RequestBody RegisterRequest request) {&#10;        System.out.println(&quot;[REGISTER] username=&quot; + request.getUsername() + &quot;, email=&quot; + request.getEmail());&#10;        String message = authService.registerWithEmailVerification(&#10;            request.getUsername(), &#10;            request.getEmail(), &#10;            request.getPassword()&#10;        );&#10;        return ResponseEntity.ok(message);&#10;    }&#10;&#10;    // Nový endpoint pro verifikaci emailu&#10;    @PostMapping(&quot;/verify-email&quot;)&#10;    public ResponseEntity&lt;String&gt; verifyEmail(@RequestBody VerifyRequest request) {&#10;        System.out.println(&quot;[VERIFY] email=&quot; + request.getEmail() + &quot;, code=&quot; + request.getVerificationCode());&#10;        String message = authService.verifyEmail(request.getEmail(), request.getVerificationCode());&#10;        return ResponseEntity.ok(message);&#10;    }&#10;&#10;    // Původní endpoint pro zpětnou kompatibilitu&#10;    @PostMapping(&quot;/register-simple&quot;)&#10;    public ResponseEntity&lt;String&gt; registerSimple(@RequestBody LoginRequest request) {&#10;        System.out.println(&quot;[REGISTER-SIMPLE] username=&quot; + request.getUsername());&#10;        authService.register(request.getUsername(), request.getPassword());&#10;        return ResponseEntity.ok(&quot;Registrace úspěšná&quot;);&#10;    }&#10;&#10;    @PostMapping(&quot;/login&quot;)&#10;    public ResponseEntity&lt;String&gt; login(@RequestBody LoginRequest request) {&#10;        boolean success = authService.login(request.getUsername(), request.getPassword());&#10;        return success ? ResponseEntity.ok(&quot;Přihlášení úspěšné&quot;) :&#10;                ResponseEntity.status(401).body(&quot;Špatné údaje&quot;);&#10;    }&#10;&#10;    @GetMapping(&quot;/users&quot;)&#10;    public List&lt;UserResponse&gt; listUsers() {&#10;        return userRepository.findAll().stream()&#10;                .filter(User::isEmailVerified) // Zobrazujeme pouze ověřené uživatele&#10;                .map(u -&gt; new UserResponse(u.getId(), u.getUsername()))&#10;                .collect(Collectors.toList());&#10;    }&#10;}" />
              <option name="updatedContent" value="package com.example.budgetbites;&#10;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.http.ResponseEntity;&#10;import org.springframework.web.bind.annotation.*;&#10;&#10;import java.util.List;&#10;import java.util.stream.Collectors;&#10;&#10;// přidány importy pro logování&#10;import org.slf4j.Logger;&#10;import org.slf4j.LoggerFactory;&#10;&#10;@RestController&#10;@RequestMapping(&quot;/auth&quot;)&#10;public class AuthController {&#10;&#10;    private static final Logger logger = LoggerFactory.getLogger(AuthController.class);&#10;&#10;    @Autowired&#10;    private AuthService authService;&#10;&#10;    @Autowired&#10;    private UserRepository userRepository;&#10;&#10;    // Nový endpoint pro registraci s emailem&#10;    @PostMapping(&quot;/register&quot;)&#10;    public ResponseEntity&lt;String&gt; registerWithEmail(@RequestBody RegisterRequest request) {&#10;        logger.info(&quot;[REGISTER] username={}, email={}&quot;, request.getUsername(), request.getEmail());&#10;        String message = authService.registerWithEmailVerification(&#10;            request.getUsername(), &#10;            request.getEmail(), &#10;            request.getPassword()&#10;        );&#10;        return ResponseEntity.ok(message);&#10;    }&#10;&#10;    // Nový endpoint pro verifikaci emailu&#10;    @PostMapping(&quot;/verify-email&quot;)&#10;    public ResponseEntity&lt;String&gt; verifyEmail(@RequestBody VerifyRequest request) {&#10;        logger.info(&quot;[VERIFY] email={}, code={}&quot;, request.getEmail(), request.getVerificationCode());&#10;        String message = authService.verifyEmail(request.getEmail(), request.getVerificationCode());&#10;        return ResponseEntity.ok(message);&#10;    }&#10;&#10;    // Původní endpoint pro zpětnou kompatibilitu&#10;    @PostMapping(&quot;/register-simple&quot;)&#10;    public ResponseEntity&lt;String&gt; registerSimple(@RequestBody LoginRequest request) {&#10;        logger.info(&quot;[REGISTER-SIMPLE] username={}&quot;, request.getUsername());&#10;        authService.register(request.getUsername(), request.getPassword());&#10;        return ResponseEntity.ok(&quot;Registrace úspěšná&quot;);&#10;    }&#10;&#10;    @PostMapping(&quot;/login&quot;)&#10;    public ResponseEntity&lt;String&gt; login(@RequestBody LoginRequest request) {&#10;        boolean success = authService.login(request.getUsername(), request.getPassword());&#10;        return success ? ResponseEntity.ok(&quot;Přihlášení úspěšné&quot;) :&#10;                ResponseEntity.status(401).body(&quot;Špatné údaje&quot;);&#10;    }&#10;&#10;    @GetMapping(&quot;/users&quot;)&#10;    public List&lt;UserResponse&gt; listUsers() {&#10;        return userRepository.findAll().stream()&#10;                .filter(User::isEmailVerified) // Zobrazujeme pouze ověřené uživatele&#10;                .map(u -&gt; new UserResponse(u.getId(), u.getUsername()))&#10;                .collect(Collectors.toList());&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/backend/src/main/java/com/example/budgetbites/EmailTestController.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/backend/src/main/java/com/example/budgetbites/EmailTestController.java" />
              <option name="originalContent" value="package com.example.budgetbites;&#10;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.http.ResponseEntity;&#10;import org.springframework.web.bind.annotation.*;&#10;&#10;@RestController&#10;@RequestMapping(&quot;/test&quot;)&#10;public class EmailTestController {&#10;&#10;    @Autowired&#10;    private EmailService emailService;&#10;&#10;    @PostMapping(&quot;/email&quot;)&#10;    public ResponseEntity&lt;String&gt; testEmail(@RequestParam String email) {&#10;        try {&#10;            emailService.sendVerificationCode(email, &quot;123456&quot;);&#10;            return ResponseEntity.ok(&quot;Email byl úspěšně odeslán na adresu: &quot; + email);&#10;        } catch (Exception e) {&#10;            return ResponseEntity.status(500).body(&quot;Chyba při odesílání emailu: &quot; + e.getMessage());&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.budgetbites;&#10;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.http.ResponseEntity;&#10;import org.springframework.web.bind.annotation.*;&#10;&#10;import org.slf4j.Logger;&#10;import org.slf4j.LoggerFactory;&#10;&#10;@RestController&#10;@RequestMapping(&quot;/test&quot;)&#10;public class EmailTestController {&#10;&#10;    private static final Logger logger = LoggerFactory.getLogger(EmailTestController.class);&#10;&#10;    @Autowired&#10;    private EmailService emailService;&#10;&#10;    @PostMapping(&quot;/email&quot;)&#10;    public ResponseEntity&lt;String&gt; testEmail(@RequestParam String email) {&#10;        logger.info(&quot;[TEST-EMAIL] requested to send test email to={}&quot;, email);&#10;        try {&#10;            emailService.sendVerificationCode(email, &quot;123456&quot;);&#10;            logger.info(&quot;[TEST-EMAIL] email send success to={}&quot;, email);&#10;            return ResponseEntity.ok(&quot;Email byl úspěšně odeslán na adresu: &quot; + email);&#10;        } catch (Exception e) {&#10;            logger.error(&quot;[TEST-EMAIL] error sending email to {}: {}&quot;, email, e.getMessage(), e);&#10;            return ResponseEntity.status(500).body(&quot;Chyba při odesílání emailu: &quot; + e.getMessage());&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>